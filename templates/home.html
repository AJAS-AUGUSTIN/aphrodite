{% extends 'base.html' %}

{% load static %}

{% block content %}

<!-- ========================= SECTION MAIN ========================= -->
<section class="section-intro padding-y-sm">
<div class="container">

<div class="intro-banner-wrap">
	<img src="{% static 'images/banners/slider-img.png' %}" class="img-fluid rounded" style="margin-left: 100px;">
</div>

</div> <!-- container //  -->
</section>
<!-- ========================= SECTION MAIN END// ========================= -->

<!-- ========================= SECTION  ========================= -->
<section class="section-name padding-y-sm">
<div class="container">

<header class="section-heading">
	<a href="{% url 'store' %}" class="btn btn-outline-dark float-right">See all</a>
	<h3 class="section-title">Popular products</h3>

	<!-- cart -->
	<script type="text/javascript">
		var user = '{{request.user}}'
	
		function getToken(name) {
		let cookieValue = null;
		if (document.cookie && document.cookie !== '') {
			const cookies = document.cookie.split(';');
			for (let i = 0; i < cookies.length; i++) {
				const cookie = cookies[i].trim();
				// Does this cookie string begin with the name we want?
				if (cookie.substring(0, name.length + 1) === (name + '=')) {
					cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
					break;
				}
			}
		}
		return cookieValue;
	}
	const csrftoken = getToken('csrftoken');
	</script>




</header><!-- sect-heading -->

<div class="row">
	{% for prd in product %}
	<div class="col-md-3">
		<div class="card card-product-grid" style="height: 410px;">
			<a href="{% url 'productdetails' prd.id %}" class="img-wrap"> <img src="{{ prd.image1.url}}"> </a>
			<figcaption class="info-wrap">
				<div class="price mt-1">{{prd.brand}}</div>
				<a href="{% url 'productdetails' prd.id %}" class="title">{{prd.product_name}}</a>
				<div style="display: flex;" class="price mt-1">â‚¹{{prd.product_discount_price}} <!-- price-wrap.// -->
				{% if prd.offer_name != None %}
					{% if prd.stock != 0 %}
						<p style="margin-left: 100px;color: yellowgreen;">{{prd.offer_percent}}% offer</p> <!-- price-wrap.// -->
					{% else %}
					<p style="margin-left: 100px;color: yellowgreen;"></p> <!-- price-wrap.// -->
					{% endif %}
				{% endif %}
				</div>
				{% if prd.stock <= 0 %}
                        <h5 style="color: red; margin-top:65px ">Out of stock</h5>
                    {% else %}
                    {% if cart in_cart %}
	                    <a href="" class="btn  btn-sucess" style="width: -moz-available; margin-top:10px"  > <span class="text">Added to cart</span> <i class="fas fa-check"></i>  </a>
                    {% else %}
	                    <a href="{% url 'add_cart' prd.id %}" style="width: -moz-available; margin-top:10px "  class="btn  btn-dark" > <span class="text">Add to cart</span> <i class="fas fa-shopping-cart"></i>  </a>
                    {% endif %}
					<a href="{% url 'buy_now' prd.id %}" class="btn  btn-dark" style="width: -moz-available; margin-top: 10px;" > <span class="text">Buy Now</span> <i class="fas fa-buy"></i>  </a>
                {% endif %}
				

				<!-- <button data-product="{{product.id}}" data-action="add" class="btn btn-outline-secondary add-btn update-cart">Add to Cart</button> -->
			</figcaption>
		</div>
	</div> <!-- col.// -->
	{% endfor %}
</div> <!-- row.// -->

</div><!-- container // -->
</section>
<!-- ========================= SECTION  END// ========================= -->






</body>
</html>
<script src="{% static 'js/cart.js' %}" type="text/javascript"></script>
{% endblock %}